<h1>All Projects</h1>
<div class="columns">
  <div class="column is-10 is-offset-1">
    <div class="section has-text-centered">
      <table class="table is-striped is-fullwidth">
        <thead>
        <tr>
          <th>Project</th>
          <th>Description</th>
          <th>Created at</th>
          <th>Tests</th>
          <th>Customer</th>
          <th>Company</th>
          <% if current_user && (current_user.analyst? || current_user.admin?) %>
            <th>Received?</th>
          <% end %>
          <th></th>
        </tr>
        </thead>
        <tbody>
        <% @projects.each do |project| %>
          <tr id="table_row_<%= project.id %>">
            <td><%= link_to project.id, project_path(project) %></td>
            <td><%= link_to project.description, project_path(project) %></td>
            <td><%= link_to project.created_at.in_time_zone('America/Los_Angeles'), project_path(project) %></td>
            <td><%=  project.tests.count %></td>
            <td><%= project.user.first_name %> <%= project.user.last_name %></td>
            <td><%= project.user.company %></td>
            <% if current_user && (current_user.analyst? || current_user.admin?) %>
              <td id="received">
                <%= form_for project, remote: true do |f| %>
                  <%= f.check_box :received? %>
                <%= button_to "Update", project_path(project), method: :patch %>
                <% end %>
              </td>
            <% end %>
            <td><%= button_to "Delete Project", project, method: :delete, data: { confirm: "Are you sure?" }, class: 'button is-danger is-small' %></td>
          </tr>
        <% end %>
        </tbody>
      </table>

      <div class="columns">
        <div class="column is-4">
          <%= button_to "New Project", new_project_path, method: :get, class: 'button is-primary' %>
        </div>
      </div>

    </div>
  </div>
</div>